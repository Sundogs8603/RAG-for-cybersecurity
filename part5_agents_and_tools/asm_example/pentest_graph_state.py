# LangGraph Example: Pentesting Workflow State Definition
#
# This script defines the state for our pentesting workflow using LangGraph.
# It includes the necessary attributes to track the workflow's progress.
#
# Instructor: Omar Santos @santosomar


from typing import TypedDict, List, Optional
class AttackSurfaceState(TypedDict):
    """
    Represents the state of our attack surface management workflow.

    Attributes:
        target_domain: The initial domain to be scanned.
        subdomains: A list of discovered subdomains.
        open_ports: A dictionary mapping hosts to their open ports.
        vulnerabilities: A list of findings from the vulnerability scan.
        analysis_result: The LLM's analysis of the findings.
        is_exploitable: A boolean flag indicating if an exploitable vulnerability was found.
        report: The final compiled report.
        workflow_log: A log of the steps taken.
    """
    target_domain: str
    subdomains: Optional[List[str]]
    open_ports: Optional[dict]
    vulnerabilities: Optional[List[dict]]
    analysis_result: Optional[str]
    is_exploitable: bool
    report: Optional[str]
    workflow_log: List[str]
