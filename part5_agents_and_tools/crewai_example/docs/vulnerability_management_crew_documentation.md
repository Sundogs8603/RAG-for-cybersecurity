# Vulnerability Management CrewAI Project Documentation

## Overview

The Vulnerability Management CrewAI project is a comprehensive, AI-powered solution for conducting systematic vulnerability assessments and creating actionable remediation plans. This project leverages the CrewAI framework to orchestrate multiple specialized AI agents working together to identify, analyze, prioritize, and remediate security vulnerabilities across your infrastructure.

## Project Structure

```
vulnerability_management/
├── README.md
├── pyproject.toml
├── .env                    # Environment variables (API keys, etc.)
├── .gitignore
└── src/vulnerability_management/
    ├── __init__.py
    ├── main.py            # Entry point for running the crew
    ├── crew.py            # Main crew orchestration logic
    ├── config/
    │   ├── agents.yaml    # Agent definitions and configurations
    │   └── tasks.yaml     # Task definitions and workflows
    └── tools/
        ├── __init__.py
        └── custom_tool.py # Custom vulnerability scanning tools
```

## Agents Overview

The vulnerability management crew consists of four specialized agents, each with distinct roles and capabilities:

### 1. Vulnerability Scanner (`vulnerability_scanner`)
- **Role**: Cybersecurity Vulnerability Scanner Specialist
- **Goal**: Discover and identify security vulnerabilities across systems, networks, and applications using automated scanning tools and techniques
- **Tools Available**:
  - Nmap Scanner Tool
  - Basic Port Scanner Tool
  - CVE Lookup Tool
- **Expertise**: Network reconnaissance, service discovery, vulnerability identification

### 2. Vulnerability Analyst (`vulnerability_analyst`)
- **Role**: Senior Vulnerability Assessment Analyst
- **Goal**: Analyze discovered vulnerabilities, assess their severity, potential impact, and provide detailed technical analysis
- **Tools Available**:
  - CVE Lookup Tool
- **Expertise**: Technical vulnerability analysis, impact assessment, security intelligence

### 3. Risk Assessor (`risk_assessor`)
- **Role**: Cybersecurity Risk Assessment Specialist
- **Goal**: Evaluate and prioritize vulnerabilities based on risk level, business impact, and exploitability
- **Tools Available**:
  - CVE Lookup Tool
- **Expertise**: Risk prioritization, business impact analysis, threat landscape assessment

### 4. Remediation Advisor (`remediation_advisor`)
- **Role**: Vulnerability Remediation Specialist
- **Goal**: Develop comprehensive remediation plans, patches, and mitigation strategies for identified vulnerabilities
- **Tools Available**: None (focuses on strategic planning and recommendations)
- **Expertise**: Patch management, system hardening, remediation strategy development

## Tasks Workflow

The vulnerability management process follows a sequential workflow with four main tasks:

- Execution Mode: Sequential (`Process.sequential`) ensures ordered handoff between tasks. You can switch to hierarchical for parallelizable, independent subtasks.

### 1. Vulnerability Discovery Task
- **Agent**: Vulnerability Scanner
- **Objective**: Perform comprehensive vulnerability scanning on target systems
- **Inputs**: `target_systems` (list of IP addresses/hostnames)
- **Outputs**: Detailed vulnerability scan report with discovered vulnerabilities, CVE IDs, affected systems, and initial severity assessments

### 2. Vulnerability Analysis Task
- **Agent**: Vulnerability Analyst
- **Objective**: Analyze discovered vulnerabilities with detailed technical assessment
- **Dependencies**: Results from Vulnerability Discovery Task
- **Outputs**: Comprehensive analysis report with root cause analysis, attack vectors, and technical recommendations

### 3. Risk Prioritization Task
- **Agent**: Risk Assessor
- **Objective**: Evaluate and prioritize vulnerabilities based on business impact and threat landscape
- **Dependencies**: Results from Vulnerability Analysis Task
- **Outputs**: Risk assessment report with prioritization matrix and recommended timelines

### 4. Remediation Planning Task
- **Agent**: Remediation Advisor
- **Objective**: Develop comprehensive remediation plans and strategies
- **Dependencies**: Results from Risk Prioritization Task
- **Outputs**: Detailed remediation plan document (`vulnerability_remediation_plan.md`)

## Custom Tools Documentation

### NmapScanTool
Performs network vulnerability scanning using Nmap.

- Tool name in crew: `nmap_vulnerability_scanner`

**Parameters**:
- `target`: IP address or hostname to scan
- `scan_type`: Type of scan ("basic", "aggressive", "stealth", "service")
- `ports`: Port range to scan (e.g., "1-1000", "80,443,22")

**Usage**: Ideal for initial network reconnaissance and service discovery.

### CVELookupTool
Retrieves detailed information about specific CVE vulnerabilities.

- Tool name in crew: `cve_vulnerability_lookup`

**Parameters**:
- `cve_id`: CVE identifier (e.g., "CVE-2021-44228")

**Usage**: Provides comprehensive vulnerability information including CVSS scores, descriptions, and severity ratings.

### PortScanTool
Performs basic port scanning using socket connections.

- Tool name in crew: `basic_port_scanner`

**Parameters**:
- `target`: Target IP address or hostname
- `ports`: List of ports to scan (defaults to common ports)
- `timeout`: Connection timeout in seconds

**Usage**: Lightweight alternative to Nmap for quick port status checks.

## Installation and Setup

### Prerequisites
- Python >= 3.10 and < 3.14
- CrewAI framework (installed via project dependencies)
- Network access for target systems
- Proper authorization for vulnerability scanning

### Installation Steps

1. **Navigate to the project directory**:
   ```bash
   cd vulnerability_management
   ```

2. **Install dependencies** (choose one):
   - From repository root (recommended):
     ```bash
     pip install -r ../requirements.txt
     ```
   - From this subproject only:
     ```bash
     pip install "crewai[tools]>=0.175.0,<1.0.0" requests
     ```

3. **Configure environment variables**:
   Edit the `.env` file to include your API keys (e.g., OpenAI API key for LLM access).

4. **Install system tools** (optional but recommended):
   ```bash
   # macOS
   brew install nmap
   
   # Ubuntu/Debian
   sudo apt-get install nmap
   
   # RHEL/CentOS
   sudo yum install nmap
   ```

## Usage

### Basic Usage

1. **Configure target systems** in `main.py`:
   ```python
   inputs = {
       'target_systems': [
           "192.168.1.100",  # Internal server
           "example.com",     # External domain
           "10.0.0.1"         # Network device
       ]
   }
   ```

2. **Run the vulnerability assessment**:
   ```bash
   cd vulnerability_management
   crewai run
   ```

### Advanced Usage

#### Training the Crew
```bash
crewai train <number_of_iterations> <training_file>
```

#### Testing the Crew
```bash
crewai test <number_of_iterations> <eval_llm>
```

#### Replaying Specific Tasks
```bash
crewai replay <task_id>
```

#### Alternative CLI entry points (via `pyproject.toml` scripts)
```bash
# Run the vulnerability assessment (equivalent to crewai run)
vulnerability_management
run_crew

# Train/test/replay helpers
train 5 path/to/training_file
replay <task_id>
test 3 gpt-5-mini
```

## Security Considerations

### Authorization Requirements
- **Always obtain proper authorization** before scanning any systems
- Ensure you have written permission for all target systems
- Follow your organization's security policies and procedures

### Ethical Scanning Practices
- Use non-disruptive scanning techniques
- Avoid scanning during business-critical hours
- Respect rate limits and system resources
- Document all scanning activities

### Data Handling
- Treat vulnerability scan results as sensitive information
- Store results securely and limit access on a need-to-know basis
- Follow data retention policies for vulnerability reports
- Encrypt sensitive data at rest and in transit

## Configuration

### Agent Configuration
Agents are configured in `src/vulnerability_management/config/agents.yaml`. You can customize:
- Agent roles and goals
- Backstories and personalities
- Tool assignments

### Task Configuration
Tasks are configured in `src/vulnerability_management/config/tasks.yaml`. You can customize:
- Task descriptions and objectives
- Expected outputs and formats
- Agent assignments
- Output file specifications

### Environment Configuration
The `.env` file contains:
- API keys for LLM services
- Model configurations
- Other environment-specific settings

## Output Files

### Primary Output
- `vulnerability_remediation_plan.md`: Comprehensive remediation plan with step-by-step procedures

### Additional Outputs
- Console logs with detailed execution information
- Individual task outputs available through CrewAI's task output system

## Troubleshooting

### Common Issues

1. **Nmap not found**:
   - Install Nmap using your system's package manager
   - Ensure Nmap is in your system PATH

2. **Permission denied errors**:
   - Verify you have proper authorization for target systems
   - Check network connectivity and firewall rules

3. **API rate limits**:
   - Monitor API usage for CVE lookup operations
   - Implement appropriate delays between requests

4. **CrewAI configuration errors**:
   - Verify YAML syntax in agent and task configuration files
   - Check that all required fields are properly defined

5. **Module not found: requests**:
   - Install missing dependency: `pip install requests`

### Performance Optimization

- **Target Selection**: Focus on critical systems first
- **Scan Timing**: Schedule scans during low-usage periods
- **Parallel Processing**: Consider using hierarchical process for independent tasks
- **Resource Management**: Monitor system resources during extensive scans

## Integration Options

### CI/CD Pipeline Integration
The vulnerability management crew can be integrated into CI/CD pipelines for automated security assessments:

```yaml
# Example GitHub Actions workflow
- name: Run Vulnerability Assessment
  run: |
    cd vulnerability_management
    crewai run
```

### API Integration
Create wrapper APIs for integrating with existing security orchestration platforms:

```python
from vulnerability_management.crew import VulnerabilityManagement

def api_vulnerability_scan(target_systems):
    inputs = {'target_systems': target_systems}
    return VulnerabilityManagement().crew().kickoff(inputs=inputs)
```

## Best Practices

### Planning Phase
1. Define clear scope and objectives
2. Obtain all necessary approvals
3. Schedule scans to minimize business impact
4. Prepare incident response procedures

### Execution Phase
1. Start with least intrusive scans
2. Monitor system performance impact
3. Document all findings immediately
4. Maintain chain of custody for evidence

### Post-Assessment Phase
1. Validate all findings
2. Prioritize remediation efforts
3. Create implementation timelines
4. Schedule follow-up assessments

## Extending the Project

### Adding New Tools
1. Create new tool classes in `tools/custom_tool.py`
2. Import tools in `crew.py`
3. Assign tools to appropriate agents
4. Update documentation

### Customizing Agents
1. Modify agent configurations in `agents.yaml`
2. Adjust roles, goals, and backstories as needed
3. Update tool assignments based on new requirements

### Adding New Tasks
1. Define new tasks in `tasks.yaml`
2. Create corresponding task methods in `crew.py`
3. Update the workflow sequence as needed

## Support and Maintenance

### Regular Updates
- Monitor CVE databases for new vulnerabilities
- Update scanning tools and techniques
- Review and update agent configurations
- Test the crew with new scenarios

### Community Resources
- CrewAI Documentation: https://docs.crewai.com/
- CVE Database: https://cve.mitre.org/
- NIST NVD: https://nvd.nist.gov/


